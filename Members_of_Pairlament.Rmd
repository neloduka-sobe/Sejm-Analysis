---
title: "Analysis of Members of Polish Parliament"
subtitle: "Based on data from api.sejm.gov.pl"
author: "Borys ≈Åangowicz (neloduka_sobe)"
format:
  html:
    code-tools: true
    code-fold: true
number-sections: true
editor: visual
include-after-body: "footer.html"
---

# Loading the Data
```{R}
# Libraries
library(knitr)
library(dplyr, warn.conflicts = FALSE)
options(dplyr.summarise.inform = FALSE)
library(ggplot2)
library(treemapify)
library(DT)

# Data
mp_path <- "./Data/mp.csv"
clubs_path <- "./Data/clubs.csv"
mp <- read.csv(mp_path)
clubs <- read.csv(clubs_path)
```

# Background of the data
This data has been downloaded from [API of Polish Parliament](https://api.sejm.gov.pl/), to analyze the general statistics considering Polish MPs, and to give an insights on political processes of the Polish political body.

# Description of the Data

## Members of Parliament
```{R}
datatable(mp, filter = "top")
```

**`active`**: Determines if MP is an active MP

**`birthDate`**: Date of birth

**`birthLocation`**: Location of birth

**`club`**: Club membership

**`districtName`**: Name of the district of the MP

**`districtNum`**: Number of the district of the MP

**`educationLevel`**: Education level of the MP

**`email`**: E-mail to the MP

**`firstLastName`**: First and last name of the MP

**`firstName`**: First name of the MP

**`id`**: Id of the MP

**`lastFirstName`**: Last and first name of the MP

**`lastName`**: Last name of the MP

**`numberOfVotes`**: Number of votes for the MP

**`profession`**: Profession of the MP

**`secondName`**: Second name

**`voivodeship`**: Voivodeship of the MP

**`inactiveCause`**: The cause why MP is inactive (if inactive)

**`waiverDesc`**: Description of the cause why MP is inactive (if inactive)

## Clubs
```{R}
kable(clubs)
```
**`email`**: E-mail of the club

**`fax`**: Fax of the club

**`id`**: Id of the club

**`membersCount`**: Number of members

**`name`**: Name of the club

**`phone`**: Phone number of the club

# Cleaning the Data

We would drop phone, email, and fax of the club, as it is data, we don't need for the statistical analysis
```{R}
clubs <- clubs %>% 
  select(id, membersCount, name)
```

We would also drop `firstLastName`, and `lastFirstName`, as those are redundant in respect to `firstName`, `secondName`, and `lastName`
```{R}
mp <- mp %>% 
  select(!c(firstLastName, lastFirstName))
```

# Translating the data #TODO

# What is the club distribution in the parliament?
```{R}
club_distribution <- mp %>% group_by(club) %>% 
  summarise(number_of_members = n()) %>% 
  arrange(desc(number_of_members))
kable(club_distribution)
```

As we can see from the table the biggest club in the parliament right now is PiS with 192 MPs.

# What is the distribution of rhe MPs per voivodeships?
```{R}
voivodeship_distribution <- mp %>% 
  group_by(voivodeship, club) %>% 
  summarise(number_of_members = n()) %>% 
  arrange(voivodeship, desc(number_of_members))

per_voivodeship <- voivodeship_distribution %>% 
  group_by(voivodeship) %>% 
  summarise(number_of_members = sum(number_of_members))

ggplot(per_voivodeship, aes(x="", y=number_of_members, fill=voivodeship)) + geom_bar(stat="identity") + coord_polar("y")
```

# What is the distribution of rhe MPs per voivodeship with regard to the club?
```{R}
ggplot(voivodeship_distribution, aes(fill=club, y=number_of_members, x=club)) + 
  geom_bar(position="dodge", stat="identity") + 
  scale_x_discrete(labels = NULL, breaks = NULL) + 
  labs(x = NULL) + 
  facet_wrap(~voivodeship)
```

# How does the distribution of education level of the Polish MPs look like?
```{R}
ggplot(mp, aes(x=educationLevel)) + geom_bar()
```

# How does the distribution of professions of the Polish MPs look like?
```{R}
```

# Are there any inactive MP? What are the causes of it?
```{R}
```

# Visualization of number of votes per MP using treemap

```{R, echo=FALSE, warning=FALSE, out.width="100%"}
ggplot(mp, aes(area=numberOfVotes, fill=club, label=paste(firstName, secondName, lastName), subgroup=club)) + geom_treemap() + geom_treemap_subgroup_border() + geom_treemap_text(min.size=1) + theme_void()
```


